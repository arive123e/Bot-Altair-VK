require('dotenv').config(); // üîê –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ .env

const TelegramBot = require('node-telegram-bot-api');

// ü§ñ –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
const token = process.env.TELEGRAM_BOT_TOKEN;

if (!token) {
  console.error('‚ùå –û—à–∏–±–∫–∞: –Ω–µ —É–∫–∞–∑–∞–Ω TELEGRAM_BOT_TOKEN –≤ .env');
  process.exit(1);
}

const bot = new TelegramBot(token, { polling: true });

// üéØ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã /start
bot.onText(/\/start/, (msg) => {
  const chatId = msg.chat.id;
  const tgId = msg.from.id;

  // ü™Ñ –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ—Ä—Ç–∞–ª –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ VK ID —Å –ø–µ—Ä–µ–¥–∞—á–µ–π tg_id
  const vkAuthUrl = `https://fokusnikaltair.xyz/vkid-auth.html?tg_id=${tgId}`;

  const welcomeText = `üßôüèº‚Äç‚ôÇÔ∏è –ü—Ä–∏–≤–µ—Ç! –Ø ‚Äî –§–æ–∫—É—Å–Ω–∏–∫ –ê–ª—å—Ç–∞–∏—Ä, —Ç–≤–æ–π –º–∞–≥–∏—á–µ—Å–∫–∏–π –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å VK.

‚ú® –Ø –ø–æ–º–æ–≥—É –ø–æ–ª—É—á–∞—Ç—å —Å–≤–µ–∂–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏–∑ –ª—é–±–∏–º—ã—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö –≥—Ä—É–ø–ø –í–ö–æ–Ω—Ç–∞–∫—Ç–µ –ø—Ä—è–º–æ –∑–¥–µ—Å—å, –≤ Telegram.
–ë–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ –∑–∞–ª–∏–ø–∞—Ç—å –≤ –ª–µ–Ω—Ç–µ ‚Äî —Ç–æ–ª—å–∫–æ –≤–∞–∂–Ω–æ–µ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ!

üîê –î–ª—è –Ω–∞—á–∞–ª–∞, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∞–≤—Ç–æ—Ä–∏–∑—É–π—Å—è —á–µ—Ä–µ–∑ VK ID ‚Äî —ç—Ç–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å —Ç–≤–æ—é –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –ª–µ–Ω—Ç—É.
`;

  bot.sendMessage(chatId, welcomeText, {
    reply_markup: {
      inline_keyboard: [
        [{ text: '–û—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç–∞–ª VK ID ‚ú®', url: vkAuthUrl }]
      ]
    }
  });

  console.log(`üì® –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ${tgId}`);
});
